<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ibm.gbs.gbs_cai_web.mapper.QnaBoardMapper">
<cache />
           
    <select id="getQnAList" resultType="com.ibm.gbs.gbs_cai_web.vo.QnaBoardVO">
        SELECT
        	 idx
        	,ref
        	,title
        	,content
        	,writer
        	,time
        	,visit
        	,(SELECT COUNT(*) FROM QnABOARD WHERE ref = A.idx) AS count
        FROM QnABOARD A
        WHERE ref = 0
        ORDER BY idx DESC;
    </select>
    
    <select id="getQnA" parameterType="int" resultType="com.ibm.gbs.gbs_cai_web.vo.QnaBoardVO">
        SELECT
        	 idx
        	,ref
        	,title
        	,content
        	,writer
        	,time
        	,visit
        	,(SELECT COUNT(*) FROM QnABOARD WHERE ref = A.idx) AS count
        FROM QnABOARD A
        WHERE idx = #{idx}
    </select>
    
    <select id="getQnAComment" parameterType="int" resultType="com.ibm.gbs.gbs_cai_web.vo.QnaBoardVO">
        SELECT
        	 idx
        	,content
        	,writer
        	,time
        FROM QnABOARD
        WHERE ref = #{ref}
    </select>
      
    <insert id="addQnA" parameterType="com.ibm.gbs.gbs_cai_web.vo.QnaBoardVO">
        INSERT INTO QnABOARD (
        	 ref
	        ,title
	        ,content
	        ,writer
	        ,time        
        )
        VALUES (
        	 #{ref}
        	,#{title}
        	,#{content}
        	,#{writer}
        	,now()	        
        )	
    </insert>
 
    <update id="updateQnA" parameterType="com.ibm.gbs.gbs_cai_web.vo.QnaBoardVO">
        UPDATE QnABOARD
        	SET title 	= #{title}
        	   ,content = #{content}
        	   ,writer	= #{writer}
		WHERE idx = #{idx}
    </update>
    
    <update id="increaseVisit" parameterType="int">
    	UPDATE QnABOARD
        	SET visit = #{arg1}
		WHERE idx = #{arg0}
    </update>
    
    <delete id="deleteQnA" parameterType="int">
        DELETE    
        FROM QnABOARD
        WHERE idx = #{idx}
    </delete>
    
</mapper>